selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
ui3 <- fluidPage(
navbarPage(
title = "Airline Traffic",
tabPanel("Introduction",
mainPanel(
h3("By Andrew Lai, Ian Lightfoot, Charlie Levitz and Jason Mares"),
p("We sought to explore how air traffic and the airline industry
was impacted by the coronavirus pandemic...")
)),
tabPanel("Static",
tabsetPanel(type = "tabs",
tabPanel("Passengers", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "State",
label = "Choose a State",
choices = states)
),
mainPanel(
plotOutput("hist")
)
),
tabPanel("Flights", fluid = TRUE,
mainPanel(
plotOutput("hist2")
)
)
)
),
tabPanel("Networks",
tabsetPanel(type = "tabs",
tabPanel("Spatial Networks", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
server2 <- function(input, output) {
data <- reactive({
filter(planes, ORIGIN_STATE_NM == input$State) %>%
group_by(MONTH) %>%
summarise(totalP = sum(PASSENGERS),
totalF = n())
})
data3 <- reactive({
i <- match(input$Month1, month)
})
title <- reactive({
paste0("Monthly Change in Domestic Air Traffic Routes in ", input$Month1," 2020")
})
output$hist <- renderPlot({ # reactive function
ggplot(data(), aes(MONTH, totalP)) +
geom_col() +
theme(axis.text.x = element_text(angle = 40, vjust = .75))
})
output$hist2 <- renderPlot({
ggplot(planesTop10Airlines, aes(x = MONTH, y = PASSENGERS/1000000, fill = reorder(AIRLINE, -PASSENGERS), color = reorder(AIRLINE, -PASSENGERS))) +
geom_line() +
geom_point(shape=21, color="black", size=3) +
xlab("Month") +
ylab("Number of Passengers (in Millions)") +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("January","February",
"March","April","May","June",
"July", "August", "September",
"October", "November", "December")) +
ggtitle("Passengers per Month by Airline") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.title = element_text(face = "bold")) +
theme(axis.text.x = element_text(angle=45, vjust = 0.5, size = 10)) +
labs(fill = "Airline", color = "Airline")
})
output$maps <- renderPlot({
states_sf %>%
ggplot(aes()) +
geom_sf(fill = "black", color = "#ffffff")+
geom_sf(data=activate(net_perc,"edges") %>% st_as_sf() %>%
select(from,to,importance,local,MONTH,value)%>% filter(MONTH==data3()) %>%arrange(desc(value)),
aes(color=value,alpha=importance,size=importance/4)) +
geom_sf(data=activate(net_perc,"nodes") %>% st_as_sf(),
aes(size=ifelse(importance>=6,importance/4,0.15)+.1),colour="black")+
geom_sf(data=activate(net_perc,"nodes") %>% st_as_sf(),
aes(size=ifelse(importance>=6,importance/4,0.15)),colour="white")+
scale_colour_viridis_c("% Change in Monthly Passenger Volume",option = 'plasma', direction=-1, limits=c(-100,100)) +
scale_size_continuous(range = c(0.25,2))+
guides(alpha=F, size=F)+
facet_wrap(~local, nrow=2)+
theme_map()+
theme(legend.position = "bottom")+
ggtitle(title())+
labs(subtitle="Growth rates are capped at -100% and 100%",
caption="Cities and routes are sized by traffic volume.")
})
output$maps2 <- renderVisNetwork({
network(1,3,min_corr1,4)
})
output$maps3 <- renderVisNetwork({
network(4,6,min_corr1,4)
})
}
ui3 <- fluidPage(
navbarPage(
title = "Airline Traffic",
tabPanel("Introduction",
mainPanel(
h3("By Andrew Lai, Ian Lightfoot, Charlie Levitz and Jason Mares"),
p("We sought to explore how air traffic and the airline industry
was impacted by the coronavirus pandemic...")
)),
tabPanel("Static",
tabsetPanel(type = "tabs",
tabPanel("Passengers", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "State",
label = "Choose a State",
choices = states)
),
mainPanel(
plotOutput("hist")
)
),
tabPanel("Flights", fluid = TRUE,
mainPanel(
plotOutput("hist2")
)
)
)
),
tabPanel("Networks",
tabsetPanel(type = "tabs",
tabPanel("Spatial Networks", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
ui3 <- fluidPage(
navbarPage(
title = "Airline Traffic",
tabPanel("Introduction",
mainPanel(
h3("By Andrew Lai, Ian Lightfoot, Charlie Levitz and Jason Mares"),
p("We sought to explore how air traffic and the airline industry
was impacted by the coronavirus pandemic...")
)),
tabPanel("Static",
tabsetPanel(type = "tabs",
tabPanel("Passengers", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "State",
label = "Choose a State",
choices = states)
),
mainPanel(
plotOutput("hist")
)
),
tabPanel("Flights", fluid = TRUE,
mainPanel(
plotOutput("hist2")
)
)
)
),
tabPanel("Networks",
tabsetPanel(type = "tabs",
tabPanel("Spatial Networks", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
server2 <- function(input, output) {
data <- reactive({
filter(planes, ORIGIN_STATE_NM == input$State) %>%
group_by(MONTH) %>%
summarise(totalP = sum(PASSENGERS),
totalF = n())
})
data3 <- reactive({
i <- match(input$Month1, month)
})
title <- reactive({
paste0("Monthly Change in Domestic Air Traffic Routes in ", input$Month1," 2020")
})
output$hist <- renderPlot({ # reactive function
ggplot(data(), aes(MONTH, totalP)) +
geom_col() +
theme(axis.text.x = element_text(angle = 40, vjust = .75))
})
output$hist2 <- renderPlot({
ggplot(planesTop10Airlines, aes(x = MONTH, y = PASSENGERS/1000000, fill = reorder(AIRLINE, -PASSENGERS), color = reorder(AIRLINE, -PASSENGERS))) +
geom_line() +
geom_point(shape=21, color="black", size=3) +
xlab("Month") +
ylab("Number of Passengers (in Millions)") +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("January","February",
"March","April","May","June",
"July", "August", "September",
"October", "November", "December")) +
ggtitle("Passengers per Month by Airline") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.title = element_text(face = "bold")) +
theme(axis.text.x = element_text(angle=45, vjust = 0.5, size = 10)) +
labs(fill = "Airline", color = "Airline")
})
output$maps <- renderPlot({
states_sf %>%
ggplot(aes()) +
geom_sf(fill = "black", color = "#ffffff")+
geom_sf(data=activate(net_perc,"edges") %>% st_as_sf() %>%
select(from,to,importance,local,MONTH,value)%>% filter(MONTH==data3()) %>%arrange(desc(value)),
aes(color=value,alpha=importance,size=importance/4)) +
geom_sf(data=activate(net_perc,"nodes") %>% st_as_sf(),
aes(size=ifelse(importance>=6,importance/4,0.15)+.1),colour="black")+
geom_sf(data=activate(net_perc,"nodes") %>% st_as_sf(),
aes(size=ifelse(importance>=6,importance/4,0.15)),colour="white")+
scale_colour_viridis_c("% Change in Monthly Passenger Volume",option = 'plasma', direction=-1, limits=c(-100,100)) +
scale_size_continuous(range = c(0.25,2))+
guides(alpha=F, size=F)+
facet_wrap(~local, nrow=2)+
theme_map()+
theme(legend.position = "bottom")+
ggtitle(title())+
labs(subtitle="Growth rates are capped at -100% and 100%",
caption="Cities and routes are sized by traffic volume.")
})
output$maps2 <- renderVisNetwork({
network(1,3,min_corr1,4)
})
output$maps3 <- renderVisNetwork({
network(4,6,min_corr1,4)
})
}
shinyApp(ui = ui3, server = server2)
ui3 <- fluidPage(
navbarPage(
title = "Airline Traffic",
tabPanel("Introduction",
mainPanel(
h3("By Andrew Lai, Ian Lightfoot, Charlie Levitz and Jason Mares"),
p("We sought to explore how air traffic and the airline industry
was impacted by the coronavirus pandemic...")
)
),
tabPanel("Static",
tabsetPanel(type = "tabs",
tabPanel("Passengers", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "State",
label = "Choose a State",
choices = states)
),
mainPanel(
plotOutput("hist")
)
),
tabPanel("Flights", fluid = TRUE,
mainPanel(
plotOutput("hist2")
)
)
)
),
tabPanel("Networks",
tabsetPanel(type = "tabs",
tabPanel("Spatial Networks", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
shinyApp(ui = ui3, server = server2)
shinyApp(ui = ui3, server = server2)
ui3 <- fluidPage(
titlePanel("Airline Traffic"),
navbarPage(
title = "Airline Traffic",
tabPanel("Introduction",
mainPanel(
h3("By Andrew Lai, Ian Lightfoot, Charlie Levitz and Jason Mares"),
p("We sought to explore how air traffic and the airline industry
was impacted by the coronavirus pandemic...")
)
),
tabPanel("Static",
tabsetPanel(type = "tabs",
tabPanel("Passengers", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "State",
label = "Choose a State",
choices = states)
),
mainPanel(
plotOutput("hist")
)
),
tabPanel("Flights", fluid = TRUE,
mainPanel(
plotOutput("hist2")
)
)
)
),
tabPanel("Networks",
tabsetPanel(type = "tabs",
tabPanel("Spatial Networks", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
shinyApp(ui = ui3, server = server2)
shinyApp(ui = ui3, server = server2)
server2 <- function(input, output) {
data <- reactive({
filter(planes, ORIGIN_STATE_NM == input$State) %>%
group_by(MONTH) %>%
summarise(totalP = sum(PASSENGERS),
totalF = n())
})
data3 <- reactive({
i <- match(input$Month1, month)
})
title <- reactive({
paste0("Monthly Change in Domestic Air Traffic Routes in ", input$Month1," 2020")
})
output$hist <- renderPlot({ # reactive function
ggplot(data(), aes(MONTH, totalP)) +
geom_col() +
theme(axis.text.x = element_text(angle = 40, vjust = .75))
})
output$hist2 <- renderPlot({
ggplot(planesTop10Airlines, aes(x = MONTH, y = PASSENGERS/1000000, fill = reorder(AIRLINE, -PASSENGERS), color = reorder(AIRLINE, -PASSENGERS))) +
geom_line() +
geom_point(shape=21, color="black", size=3) +
xlab("Month") +
ylab("Number of Passengers (in Millions)") +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("January","February",
"March","April","May","June",
"July", "August", "September",
"October", "November", "December")) +
ggtitle("Passengers per Month by Airline") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(plot.title = element_text(face = "bold")) +
theme(axis.text.x = element_text(angle=45, vjust = 0.5, size = 10)) +
labs(fill = "Airline", color = "Airline")
})
output$maps <- renderPlot({
states_sf %>%
ggplot(aes()) +
geom_sf(fill = "black", color = "#ffffff")+
geom_sf(data=activate(net_perc,"edges") %>% st_as_sf() %>%
select(from,to,importance,local,MONTH,value)%>% filter(MONTH==data3()) %>%arrange(desc(value)),
aes(color=value,alpha=importance,size=importance/4)) +
geom_sf(data=activate(net_perc,"nodes") %>% st_as_sf(),
aes(size=ifelse(importance>=6,importance/4,0.15)+.1),colour="black")+
geom_sf(data=activate(net_perc,"nodes") %>% st_as_sf(),
aes(size=ifelse(importance>=6,importance/4,0.15)),colour="white")+
scale_colour_viridis_c("% Change in Monthly Passenger Volume",option = 'plasma', direction=-1, limits=c(-100,100)) +
scale_size_continuous(range = c(0.25,2))+
guides(alpha=F, size=F)+
facet_wrap(~local, nrow=2)+
theme_map()+
theme(legend.position = "bottom")+
ggtitle(title())+
labs(subtitle="Growth rates are capped at -100% and 100%",
caption="Cities and routes are sized by traffic volume.")
})
output$maps2 <- renderVisNetwork({
network(1,3,min_corr1,4)
})
output$maps3 <- renderVisNetwork({
network(4,6,min_corr1,4)
})
}
ui3 <- fluidPage(
titlePanel("Airline Traffic"),
navbarPage(
#title = "Airline Traffic",
tabPanel("Introduction",
mainPanel(
h3("By Andrew Lai, Ian Lightfoot, Charlie Levitz and Jason Mares"),
p("We sought to explore how air traffic and the airline industry
was impacted by the coronavirus pandemic...")
)
),
tabPanel("Static",
tabsetPanel(type = "tabs",
tabPanel("Passengers", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "State",
label = "Choose a State",
choices = states)
),
mainPanel(
plotOutput("hist")
)
),
tabPanel("Flights", fluid = TRUE,
mainPanel(
plotOutput("hist2")
)
)
)
),
tabPanel("Networks",
tabsetPanel(type = "tabs",
tabPanel("Spatial Networks", fluid = TRUE,
sidebarPanel(
selectInput(inputId = "Month1",
label = "Choose a Month",
choices = month)
),
mainPanel(
plotOutput("maps")
)
),
tabPanel("Interactive Networks", fluid = TRUE,
splitLayout(
visNetworkOutput("maps2"),
visNetworkOutput("maps3")
))
)
),
tabPanel("Text")
)
shinyApp(ui = ui3, server = server2)
shinyApp(ui = ui3, server = server2)
